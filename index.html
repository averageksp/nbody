<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Solar System Simulation – Full System with Gravity, Asteroids, Zoom & Pan</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #121212;
    color: #eee;
    font-family: sans-serif;
    overflow: hidden;
  }
  canvas {
    display: block;
    background: #000;
  }
  #tooltip {
    position: fixed;
    pointer-events: none;
    background: rgba(20,20,20,0.9);
    color: #eee;
    padding: 8px;
    border-radius: 6px;
    font-size: 13px;
    display: none;
    max-width: 160px;
    z-index: 10;
  }
  #tooltip img {
    max-width: 100%;
    border-radius: 4px;
    margin-top: 6px;
  }
  #menuToggle {
    position: fixed;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20;
    background: #1e1e1e;
    border: none;
    border-radius: 4px;
    color: #eee;
    padding: 8px 12px;
    font-size: 16px;
    cursor: pointer;
  }
  #sidebar {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translate(-50%,100%);
    width: 100%;
    max-width: 600px;
    height: 300px;
    background: #1e1e1e;
    box-shadow: 0 -4px 12px rgba(0,0,0,0.6);
    padding: 20px;
    overflow-y: auto;
    overflow-x: hidden;
    transition: transform 0.3s ease;
    z-index: 15;
  }
  #sidebar.open {
    transform: translate(-50%,0);
  }
  #sidebar h2 {
    text-align: center;
    margin-bottom: 12px;
  }
  #sidebar label, #sidebar span, #sidebar button, #sidebar input {
    display: block;
    width: 100%;
    margin-bottom: 10px;
  }
  #sidebar input, #sidebar button {
    padding: 6px;
    border: none;
    border-radius: 4px;
    background: #2a2a2a;
    color: #eee;
  }
  #sidebar button:hover {
    background: #3a3a3a;
  }
  #sidebar .info {
    background: #2a2a2a;
    padding: 10px;
    border-radius: 6px;
    margin-bottom: 12px;
  }
  #sidebar small {
    color: #aaa;
  }
</style>
</head>
<body>
<canvas id="orbitCanvas"></canvas>
<div id="tooltip"></div>
<button id="menuToggle">☰ Controls</button>
<div id="sidebar">
  <h2>Simulation Controls</h2>
  <label>Speed: <span id="speedValue">1</span></label>
  <input id="speedControl" type="range" min="1" max="100" value="1"/>
  <div class="info">
    <strong>Time:</strong> <div id="timeValue">0y 0m 0d 0h</div>
  </div>
  <div class="info">
    <button id="resetButton">Reset Trails</button>
  </div>
  <div class="info">
    <button id="spawnAsteroidButton">Spawn Asteroid</button>
  </div>
</div>

<script>
const G = 6.6743e-11, AU = 1.496e11, day = 24*3600;
const canvas = document.getElementById('orbitCanvas');
const ctx = canvas.getContext('2d');
const tooltip = document.getElementById('tooltip');
const sidebar = document.getElementById('sidebar');
const btnMenu = document.getElementById('menuToggle');
const speedSlider = document.getElementById('speedControl');
const speedLabel = document.getElementById('speedValue');
const timeValue = document.getElementById('timeValue');
const resetButton = document.getElementById('resetButton');
const spawnAsteroidButton = document.getElementById('spawnAsteroidButton');

let W = window.innerWidth, H = window.innerHeight;
canvas.width = W; canvas.height = H;

let scale = W / (12 * AU);
let offsetX = W / 2, offsetY = H / 2;
let speed = parseInt(speedSlider.value);
let elapsed = 0;
let isDragging = false, dragStartX, dragStartY;

speedSlider.oninput = () => {
  speed = parseInt(speedSlider.value);
  speedLabel.textContent = speed;
};

btnMenu.onclick = () => sidebar.classList.toggle('open');

resetButton.onclick = () => {
  trails.forEach(t => t.length = 0);
};

spawnAsteroidButton.onclick = () => {
  spawnAsteroid();
};

const sunMass = 1.99e30;
const bodies = [
  {name: 'Sun', mass: sunMass, a: 0, e: 0, color: 'orange', img: 'https://upload.wikimedia.org/wikipedia/commons/4/4c/Sun_white.jpg', info: 'Sun, center.'},
  {name: 'Mercury', mass: 3.3e23, a: 0.39, e: 0.206, color: 'gray', img: 'https://upload.wikimedia.org/wikipedia/commons/4/4a/Mercury_in_true_color.jpg', info: 'Mercury, closest to Sun.'},
  {name: 'Venus', mass: 4.87e24, a: 0.72, e: 0.007, color: 'gold', img: 'https://upload.wikimedia.org/wikipedia/commons/e/e5/Venus-real_color.jpg', info: 'Venus, Earth’s sister.'},
  {name: 'Earth', mass: 5.97e24, a: 1.0, e: 0.017, color: 'blue', img: 'https://upload.wikimedia.org/wikipedia/commons/9/97/The_Earth_seen_from_Apollo_17.jpg', info: 'Our home planet.'},
  {name: 'Mars', mass: 6.42e23, a: 1.52, e: 0.093, color: 'red', img: 'https://upload.wikimedia.org/wikipedia/commons/0/02/OSIRIS_Mars_true_color.jpg', info: 'Mars, the red planet.'},
  {name: 'Jupiter', mass: 1.9e27, a: 5.2, e: 0.049, color: 'brown', img: 'https://upload.wikimedia.org/wikipedia/commons/4/4f/Jupiter_Amalthea_print.jpg', info: 'Jupiter, the largest planet.'},
  {name: 'Saturn', mass: 5.68e26, a: 9.58, e: 0.056, color: 'gold', img: 'https://upload.wikimedia.org/wikipedia/commons/9/94/Saturn_%28planet%29.jpg', info: 'Saturn, known for its rings.'},
  {name: 'Uranus', mass: 8.68e25, a: 19.18, e: 0.046, color: 'lightblue', img: 'https://upload.wikimedia.org/wikipedia/commons/e/e3/Uranus2.jpg', info: 'Uranus, tilted rotation.'},
  {name: 'Neptune', mass: 1.02e26, a: 30.07, e: 0.010, color: 'darkblue', img: 'https://upload.wikimedia.org/wikipedia/commons/e/e1/Neptune_Full.jpg', info: 'Neptune, the wind giant.'},
  {name: 'Pluto', mass: 1.31e22, a: 39.48, e: 0.248, color: 'grey', img: 'https://upload.wikimedia.org/wikipedia/commons/d/d7/Pluto_in_True_Colour.jpg', info: 'Pluto, a dwarf planet.'}
];

const moons = [
  {planet: 'Earth', name: 'Moon', mass: 7.35e22, a: 0.00257, e: 0.055, color: 'lightgray', img: 'https://upload.wikimedia.org/wikipedia/commons/4/42/FullMoon2010.jpg', info: 'Earth\'s Moon.'},
  {planet: 'Mars', name: 'Phobos', mass: 1.0659e16, a: 0.00094, e: 0.015, color: 'grey', img: 'https://upload.wikimedia.org/wikipedia/commons/2/2d/Phobos_2008.jpg', info: 'Phobos, moon of Mars.'}
];

let asteroids = [];

function spawnAsteroid() {
  const randomAngle = Math.random() * Math.PI * 2;
  const randomDistance = Math.random() * (300 * AU - 100 * AU) + 100 * AU;
  const asteroid = {
    mass: 1e14,
    a: randomDistance / AU,
    e: 0.1,
    angle: randomAngle,
    color: 'gray',
    x: Math.cos(randomAngle) * randomDistance + offsetX,
    y: Math.sin(randomAngle) * randomDistance + offsetY
  };
  asteroids.push(asteroid);
}

function distance(a, b) {
  return Math.sqrt((a.x - b.x) ** 2 + (a.y - b.y) ** 2);
}

function applyGravity(bodies) {
  bodies.forEach((b, i) => {
    bodies.forEach((b2, j) => {
      if (i !== j) {
        const d = distance(b, b2);
        const F = G * (b.mass * b2.mass) / (d * d);
        const angle = Math.atan2(b2.y - b.y, b2.x - b.x);
        const fx = Math.cos(angle) * F;
        const fy = Math.sin(angle) * F;
        b.vx += fx / b.mass;
        b.vy += fy / b.mass;
      }
    });
  });
}

function updateBodies(bodies, asteroids) {
  applyGravity(bodies.concat(asteroids));
  
  bodies.forEach(b => {
    b.x += b.vx * speed;
    b.y += b.vy * speed;
    b.vx *= 0.99; b.vy *= 0.99; // friction-like slowdown for stability
  });
  
  asteroids.forEach(a => {
    a.x += a.vx * speed;
    a.y += a.vy * speed;
    a.vx *= 0.99; a.vy *= 0.99;
  });
}

function drawBodies(bodies, asteroids) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  bodies.concat(asteroids).forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x * scale + offsetX, b.y * scale + offsetY, 4, 0, Math.PI * 2);
    ctx.fillStyle = b.color;
    ctx.fill();
  });
}

function handleMouseWheel(event) {
  scale *= event.deltaY < 0 ? 1.1 : 0.9;
  event.preventDefault();
}

function handleMouseDown(event) {
  isDragging = true;
  dragStartX = event.clientX;
  dragStartY = event.clientY;
}

function handleMouseMove(event) {
  if (isDragging) {
    const dx = event.clientX - dragStartX;
    const dy = event.clientY - dragStartY;
    offsetX += dx;
    offsetY += dy;
    dragStartX = event.clientX;
    dragStartY = event.clientY;
  }
}

function handleMouseUp() {
  isDragging = false;
}

canvas.addEventListener('wheel', handleMouseWheel);
canvas.addEventListener('mousedown', handleMouseDown);
canvas.addEventListener('mousemove', handleMouseMove);
canvas.addEventListener('mouseup', handleMouseUp);

function updateSimulation() {
  elapsed++;
  updateBodies(bodies, asteroids);
  drawBodies(bodies, asteroids);
  timeValue.textContent = `${Math.floor(elapsed / 365)}y ${Math.floor(elapsed % 365)}d`;
  requestAnimationFrame(updateSimulation);
}

updateSimulation();
</script>
</body>
</html>
