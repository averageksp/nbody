<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>2D Orbital Simulation – Enhanced UI</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #121212;
    color: #eee;
    font-family: sans-serif;
    overflow: hidden;
  }
  canvas {
    display: block;
    background: #000;
  }
  #tooltip {
    position: fixed;
    pointer-events: none;
    background: rgba(20,20,20,0.9);
    color: #eee;
    padding: 8px;
    border-radius: 6px;
    font-size: 13px;
    display: none;
    max-width: 160px;
    z-index: 10;
  }
  #tooltip img {
    max-width: 100%;
    border-radius: 4px;
    margin-top: 6px;
  }
  #menuToggle {
    position: fixed;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20;
    background: #1e1e1e;
    border: none;
    border-radius: 4px;
    color: #eee;
    padding: 8px 12px;
    font-size: 16px;
    cursor: pointer;
  }
  #sidebar {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translate(-50%,100%);
    width: 100%;
    max-width: 600px;
    height: 300px;
    background: #1e1e1e;
    box-shadow: 0 -4px 12px rgba(0,0,0,0.6);
    padding: 20px;
    overflow-y: auto;
    overflow-x: hidden;
    transition: transform 0.3s ease;
    z-index: 15;
  }
  #sidebar.open {
    transform: translate(-50%,0);
  }
  #sidebar h2 {
    text-align: center;
    margin-bottom: 12px;
  }
  #sidebar label, #sidebar span, #sidebar button, #sidebar input {
    display: block;
    width: 100%;
    margin-bottom: 10px;
  }
  #sidebar input, #sidebar button {
    padding: 6px;
    border: none;
    border-radius: 4px;
    background: #2a2a2a;
    color: #eee;
  }
  #sidebar button:hover {
    background: #3a3a3a;
  }
  #sidebar .info {
    background: #2a2a2a;
    padding: 10px;
    border-radius: 6px;
    margin-bottom: 12px;
  }
  #sidebar small {
    color: #aaa;
  }
</style>
</head>
<body>
<canvas id="orbitCanvas"></canvas>
<div id="tooltip"></div>
<button id="menuToggle">☰ Controls</button>
<div id="sidebar">
  <h2>Simulation Controls</h2>
  <label>Speed: <span id="speedValue">1</span></label>
  <input id="speedControl" type="range" min="1" max="100" value="1"/>
  <div class="info">
    <strong>Time:</strong> <div id="timeValue">0y 0m 0d 0h</div>
  </div>
  <div class="info">
    <button id="resetButton">Reset Trails</button>
  </div>
</div>

<script>
const G = 6.6743e-11, AU = 1.496e11, day = 24*3600;
const canvas = document.getElementById('orbitCanvas');
const ctx = canvas.getContext('2d');
const tooltip = document.getElementById('tooltip');
const sidebar = document.getElementById('sidebar');
const btnMenu = document.getElementById('menuToggle');
const speedSlider = document.getElementById('speedControl');
const speedLabel = document.getElementById('speedValue');
const timeValue = document.getElementById('timeValue');
const resetButton = document.getElementById('resetButton');

let W = window.innerWidth, H = window.innerHeight;
canvas.width = W; canvas.height = H;

let scale = W / (12 * AU);
let offsetX = W / 2, offsetY = H / 2;
let speed = parseInt(speedSlider.value);
let elapsed = 0;

speedSlider.oninput = () => {
  speed = parseInt(speedSlider.value);
  speedLabel.textContent = speed;
};

btnMenu.onclick = () => sidebar.classList.toggle('open');

resetButton.onclick = () => {
  trails.forEach(t => t.length = 0);
};

const sunMass = 1.99e30;
const bodies = [
  {name: 'Sun', mass: sunMass, a: 0, e: 0, color: 'orange', img: 'https://upload.wikimedia.org/wikipedia/commons/4/4c/Sun_white.jpg', info: 'Sun, center.'},
  {name: 'Mercury', mass: 3.3e23, a: 0.39, e: 0.206, color: 'gray', img: 'https://upload.wikimedia.org/wikipedia/commons/4/4a/Mercury_in_true_color.jpg', info: 'Mercury, closest to Sun.'},
  {name: 'Venus', mass: 4.87e24, a: 0.72, e: 0.007, color: 'gold', img: 'https://upload.wikimedia.org/wikipedia/commons/e/e5/Venus-real_color.jpg', info: 'Venus, Earth’s sister.'},
  {name: 'Earth', mass: 5.97e24, a: 1.0, e: 0.017, color: 'blue', img: 'https://upload.wikimedia.org/wikipedia/commons/9/97/The_Earth_seen_from_Apollo_17.jpg', info: 'Our home planet.'},
  {name: 'Mars', mass: 6.42e23, a: 1.52, e: 0.093, color: 'red', img: 'https://upload.wikimedia.org/wikipedia/commons/0/02/OSIRIS_Mars_true_color.jpg', info: 'Mars, the red planet.'}
];

let positions = [], velocities = [], masses = [], trails = [];
bodies.forEach(b => {
  masses.push(b.mass);
  if (b.a === 0) {
    positions.push([0, 0]);
    velocities.push([0, 0]);
  } else {
    let a = b.a * AU, e = b.e;
    let x = a * (1 + e), y = 0;
    let v = Math.sqrt(G * sunMass * (1 - e) / (a * (1 + e)));
    positions.push([x, y]);
    velocities.push([0, v]);
  }
  trails.push([]);
});

function computeAccelerations(pos, masses) {
  const acc = Array(pos.length).fill(0).map(() => [0, 0]);
  for (let i = 0; i < pos.length; i++) {
    for (let j = 0; j < pos.length; j++) {
      if (i === j) continue;
      let dx = pos[j][0] - pos[i][0];
      let dy = pos[j][1] - pos[i][1];
      let distSq = dx * dx + dy * dy + 1e10;
      let dist = Math.sqrt(distSq);
      let force = G * masses[j] / distSq;
      acc[i][0] += force * dx / dist;
      acc[i][1] += force * dy / dist;
    }
  }
  return acc;
}

function update() {
  let acc = computeAccelerations(positions, masses);
  for (let i = 0; i < positions.length; i++) {
    velocities[i][0] += acc[i][0] * day * 0.1;
    velocities[i][1] += acc[i][1] * day * 0.1;
    positions[i][0] += velocities[i][0] * day * 0.1;
    positions[i][1] += velocities[i][1] * day * 0.1;
    trails[i].push([...positions[i]]);
    if (trails[i].length > 1000) trails[i].shift();
  }
}

function formatTime(seconds) {
  const years = Math.floor(seconds / (3600 * 24 * 365));
  const months = Math.floor((seconds % (3600 * 24 * 365)) / (3600 * 24 * 30));
  const days = Math.floor((seconds % (3600 * 24 * 30)) / (3600 * 24));
  const hours = Math.floor((seconds % (3600 * 24)) / 3600);
  return `${years}y ${months}m ${days}d ${hours}h`;
}

function draw() {
  ctx.clearRect(0, 0, W, H);
  for (let i = 0; i < bodies.length; i++) {
    const trail = trails[i];
    ctx.beginPath();
    for (let j = 0; j < trail.length; j++) {
      const [x, y] = trail[j];
      const sx = offsetX + x * scale;
      const sy = offsetY + y * scale;
      j === 0 ? ctx.moveTo(sx, sy) : ctx.lineTo(sx, sy);
    }
    ctx.strokeStyle = bodies[i].color;
    ctx.stroke();
  }

  for (let i = 0; i < bodies.length; i++) {
    const [x, y] = positions[i];
    const sx = offsetX + x * scale;
    const sy = offsetY + y * scale;
    ctx.beginPath();
    ctx.arc(sx, sy, 5, 0, 2 * Math.PI);
    ctx.fillStyle = bodies[i].color;
    ctx.fill();
  }
}

canvas.addEventListener('mousemove', e => {
  const mx = e.clientX, my = e.clientY;
  tooltip.style.display = 'none';
  for (let i = 0; i < bodies.length; i++) {
    const [x, y] = positions[i];
    const sx = offsetX + x * scale;
    const sy = offsetY + y * scale;
    if (Math.hypot(mx - sx, my - sy) < 10) {
      const b = bodies[i];
      tooltip.innerHTML = `<strong>${b.name}</strong><br>${b.info}<br><img src="${b.img}" />`;
      tooltip.style.left = `${mx + 15}px`;
      tooltip.style.top = `${my + 15}px`;
      tooltip.style.display = 'block';
      break;
    }
  }
});

function animate() {
  for (let i = 0; i < speed; i++) {
    update();
    elapsed += day * 0.1;
  }
  timeValue.textContent = formatTime(elapsed);
  draw();
  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
